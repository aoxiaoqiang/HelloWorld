function handleConnect(e){e?($("#lineInfo").val().trim()?(setStorage("lineInfo",$("#lineInfo").val()),proxy.set(getStorage("lineInfo"))):getStorage("lineInfo")&&($("#lineInfo").val(getStorage("lineInfo")),proxy.set(getStorage("lineInfo"))),setStorage("state",e),$("[name='my-checkbox']").bootstrapSwitch("state",e),$("#lineInfo").prop("disabled",!0),$("#editLine").removeClass("btn-danger").addClass("btn-primary").text("\u7f16\u8f91\u7ebf\u8def\u4fe1\u606f")):(proxy.close(),setStorage("state",!1),$("[name='my-checkbox']").bootstrapSwitch("state",!1))}function parseLineInfo(e){var t={};try{var n=e.split(" ");return t.protocal=n[0],t.ip=n[1].split(":")[0],t.port=n[1].split(":")[1],t.state=getStorage("state")||!1,t}catch(e){return"error"}}function initURLstatus(){function e(e){t.text(e);var n="";$.get("../js/rules.json",function(o){for(var a=JSON.parse(o),i=0;i<a.length;i++)if(a[i]==e){n="sys";break}if("sys"==n)t.text("\u7cfb\u7edfURL\u65e0\u6cd5\u5220\u9664"),$(".icon-box .glyphicon-ban-circle").parent().show(),t.css("cursor","not-allowed");else if(getStorage("customRules")&&getStorage("customRules").length>0){for(var l=getStorage("customRules"),s=0,i=0;i<l.length;i++)if(s=i,l[i]==e){n="cus";break}"cus"==n?($(".icon-box .glyphicon-minus-sign").parent().show(),$("#btnHandleURL").click(function(e){e.preventDefault(),l.splice(s,1),setStorage("customRules",l),handleConnect(!0),location.reload()})):($(".icon-box .glyphicon-plus-sign").parent().show(),$("#btnHandleURL").click(function(t){t.preventDefault(),l.push(e),setStorage("customRules",l),handleConnect(!0),location.reload()}))}else $(".icon-box .glyphicon-plus-sign").parent().show(),$("#btnHandleURL").click(function(t){t.preventDefault();var n=[];n.push(e),setStorage("customRules",n),handleConnect(!0),location.reload()})})}var t=$("#btnHandleURL");chrome.tabs.query({currentWindow:!0,active:!0},function(n){var o=getDomain(n[0].url);0==o?(t.text("\u5f53\u524d\u5730\u5740\u4e0d\u53ef\u6dfb\u52a0"),$(".icon-box .glyphicon-ban-circle").parent().show(),t.button("reset")):e(o)})}function payModel(e){$("#myModal .modal-body").html('<img class="pay-img" src="../images/pay/'+e+'.jpg" alt="" />'),$("#myModal").modal()}var manifestData=chrome.runtime.getManifest(),extensionId=chrome.runtime.id,proxy=new ChromeProxy,customRules=getStorage("customRules")||[];$("#textVersion").text(" v"+manifestData.version),$("#lineInfo").val(getStorage("lineInfo")||""),$("[name='my-checkbox']").bootstrapSwitch("state",getStorage("state")||!1),getStorage("state")?activeIcon():grayIcon(),getStorage("debug")&&1==getStorage("debug")&&$(".debug-line").show(),$("#lineInfo").change(function(){setStorage("lineInfo",$(this).val())}),$('input[name="my-checkbox"]').on("switchChange.bootstrapSwitch",function(e,t){setStorage("state",t),handleConnect(t)}),$("#editLine").click(function(){$("#lineInfo").prop("disabled")?($("#lineInfo").prop("disabled",!1).focus(),$(this).removeClass("btn-primary").addClass("btn-danger").text("\u4fdd\u5b58\u7ebf\u8def\u4fe1\u606f"),handleConnect(!1)):($("#lineInfo").prop("disabled",!0),$(this).removeClass("btn-danger").addClass("btn-primary").text("\u7f16\u8f91\u7ebf\u8def\u4fe1\u606f"),handleConnect(!0))}),initURLstatus(),$("#btnOpenChromeExtensionDev").click(function(){openTab("chrome://extensions/",!0)}),$("#getInfo").click(function(e){if(e.preventDefault(),getStorage("lineInfo")){var t=parseLineInfo(getStorage("lineInfo"));if("error"!=t){var n="";n+='<p class="field"><span>\u8fde\u63a5\u72b6\u6001: </span>'+(1==t.state?"\u5df2\u8fde\u63a5":"\u5df2\u65ad\u5f00")+"</p>",n+='<p class="field"><span>\u534f\u8bae: </span>'+t.protocal+"</p>",n+='<p class="field"><span>\u4e3b\u673a\u5730\u5740: </span>'+t.ip+"</p>",n+='<p class="field"><span>\u7aef\u53e3\u53f7: </span>'+t.port+"</p>",$("#myModal .modal-body").html(n)}else $("#myModal .modal-body").html("\u7ebf\u8def\u4fe1\u606f\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5\u7ebf\u8def\u683c\u5f0f\u662f\u5426\u6b63\u786e\u3002\u6b63\u786e\u7684\u884c\u683c\u5f0f:<b> HTTP 127.0.0.1:80 </b>\uff0c\u6ce8\u610f\u68c0\u67e5\u662f\u5426\u5305\u542b\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u7a7a\u683c\u3002")}else $("#myModal .modal-body").html("\u6682\u65e0\u7ebf\u8def\u4fe1\u606f!");$("#myModal").modal()}),$("#newTab").click(function(){getStorage("debug")?openTab(location.href,!0):($("#myModal .modal-body").html("\u8bf7\u6253\u5f00\u8c03\u8bd5\u6a21\u5f0f\uff0c\u7136\u540e\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570!\u6253\u5f00\u8c03\u8bd5\u6a21\u5f0f\u65b9\u6cd5:\u201c\u5173\u4e8e\u63d2\u4ef6\u201d -> \u201c\u8c03\u8bd5\u6a21\u5f0f\u201d\u3002"),$("#myModal").modal())}),$("#getMoreLine").click(function(e){e.preventDefault();try{for(var t=proQiong.get(),n="",o=0;o<t.length;o++)n+='<div class="line-box">',n+="<p><span>"+t[o].name+": </span><br/>"+t[o].position+"</p>",n+="</div>";$("#myModal .modal-body").html(n)}catch(e){$("#myModal .modal-body").html("\u83b7\u53d6\u7ebf\u8def\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u5f00\u53d1\u8005!")}$("#myModal").modal()}),$("#getMoreLine2").click(function(e){e.preventDefault();try{for(var t=proSuperVPN.get(),n="",o=0;o<t.length;o++)n+='<div class="line-box">',n+="<p><span>"+t[o].name+": </span><br/>"+t[o].position+"</p>",n+="</div>";$("#myModal .modal-body").html(n)}catch(e){$("#myModal .modal-body").html("\u83b7\u53d6\u7ebf\u8def\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u5f00\u53d1\u8005!")}$("#myModal").modal()}),$("#btnResetPlugin").click(function(e){e.preventDefault(),window.localStorage.clear(),$("#myModal .modal-body").html("\u63d2\u4ef6\u6570\u636e\u91cd\u7f6e\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u914d\u7f6e\u670d\u52a1\u5668\u4fe1\u606f\uff01"),$("#myModal").modal(),$("#myModal").on("hidden.bs.modal",function(e){location.reload()})}),$("#btnDisabledPlugin").click(function(e){e.preventDefault(),chrome.management.setEnabled(extensionId,!1,function(){})}),$("#btnAbout").click(function(e){e.preventDefault(),$("#myModal .modal-body").html('<div class="author-say"><i class="glyphicon glyphicon-th"></i> \u63d2\u4ef6\u5bc4\u8bed<br/>&nbsp;&nbsp;&nbsp;&nbsp;\u6b64\u63d2\u4ef6\u4ec5\u4f9b\u4ea4\u6d41\u5b66\u4e60\u4f7f\u7528\uff01<br/>&nbsp;&nbsp;&nbsp;&nbsp;\u5982\u679c\u60a8\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u6709\u95ee\u9898\u6216\u5efa\u8bae\u53ef\u53ca\u65f6\u63d0\u51fa\u3002\u77e5\u8bc6\u65e0\u56fd\u754c\uff0c\u5e0c\u671b\u5927\u5bb6\u80fd\u5171\u540c\u5b66\u4e60\u3002<br/><br/><i class="glyphicon glyphicon-th"></i> \u8054\u7cfb\u65b9\u5f0f<br/>QQ: <a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=2310005831&site=qq&menu=yes">2310005831</a><br/>Email: <a href="mailto:aoxiaoqiang@163.com?subject=The%20extension%20of%20the%20feedback&body=The%20body%20of%20the%20email" id="openEmail">aoxiaoqiang@163.com</a><div class="debugger"><label><input type="checkbox" '+(getStorage("debug")?'checked="checked"':"")+'id="debugMode"></label></div></div>'),$("#openEmail").click(function(e){e.preventDefault(),openTab($(this).attr("href"),!0)}),$("#debugMode").change(function(e){setStorage("debug",$(this).prop("checked")),$(this).prop("checked")?$(".debug-line").show():$(".debug-line").hide()}),$("#myModal").modal()}),Conflictor.getConflict(function(e){if(0===e.length);else{var t="";t+='<div class="modal-conflict"><h3 class="conflict-title text-center text-danger">\u51b2\u7a81\u5217\u8868</h3>',t+='<div class="conflict-cont">',t+='<div class="conflict-info text-danger">\u8bf4\u660e\uff1a\u51b2\u7a81\u63d2\u4ef6\u4f1a\u5bfc\u81f4\u672c\u63d2\u4ef6\u65e0\u6cd5\u4f7f\u7528, \u8bf7\u53ca\u65f6\u5904\u7406\uff01</div>';for(var n=0;n<e.length;n++){var o=e[n];t+='<div class="conflict-item hint--top  hint--medium hint--bounce" data-hint="'+o.name+'">',t+='<span class="main-info"><img src="'+o.icons[o.icons.length-1].url+'" alt="'+o.name+'"/></span>',t+='<div class="btns-box">',t+='<button class="btn btn-sm btn-primary btn-disabled-extension" data-id="'+o.id+'" data-name="'+o.name+'">\u7981\u7528</button>',t+='<button class="btn btn-sm btn-danger btn-uninstall-extension" data-id="'+o.id+'" data-name="'+o.name+'">\u5378\u8f7d</button>',t+="</box>",t+="</div>",t+="</div>"}t+="</div>",t+="</div>",$("#myModal .modal-body").html(t),$(".btn-disabled-extension").on("click",function(){var e=$(this).data();Conflictor.disabled(e.id,e.name),$(this).parents(".conflict-item").remove(),showConflicNumbers(),0===$(".conflict-item").length&&$("#myModal").modal("hide")}),$(".btn-uninstall-extension").on("click",function(){var e=$(this).data();Conflictor.uninstall(e.id,e.name),$(this).parents(".conflict-item").remove(),showConflicNumbers(),0===$(".conflict-item").length&&$("#myModal").modal("hide")}),$("#myModal").modal({backdrop:"static",keyboard:!1})}}),chrome.proxy.settings.get({},function(e){console.log(e)});